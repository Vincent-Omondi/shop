<div class="columns is-centered">
  <div class="column is-8">
    <%= simple_form_for @product, html: { multipart: true, class: "box p-5 m-4 shadow-lg" } do |f| %>
      <%= f.error_notification %>

      <% if @product.errors.any? %>
        <div class="notification is-danger is-light">
          <%= @product.errors.full_messages.first %>
        </div>
      <% end %>

      <h1 class="title has-text-centered mb-5">
        <%= @product.new_record? ? 'Add New Product' : 'Edit Product' %>
      </h1>

      <div class="columns is-multiline">
        <div class="field column is-8">
          <div class="control">
            <%= f.input :title, required: true, 
                input_html: { class: "input is-medium" }, 
                wrapper: false, 
                label_html: { class: "label is-medium" } %>
          </div>
        </div>

        <div class="field column is-4">
          <div class="control">
            <%= f.input :price, required: true, 
                input_html: { class: "input is-medium", maxlength: 7 }, 
                wrapper: false, 
                label_html: { class: "label is-medium" } %>
          </div>
        </div>
      </div>

      <div class="field mb-5">
        <div class="control">
          <%= f.input :model, required: true, 
              input_html: { class: "input is-medium" }, 
              wrapper: false, 
              label_html: { class: "label is-medium" } %>
        </div>
      </div>

      <div class="field mb-5">
        <div class="control">
          <%= f.input :description, required: true, 
              input_html: { class: "textarea is-medium", rows: 5 }, 
              wrapper: false, 
              label_html: { class: "label is-medium" } %>
        </div>
      </div>

      <div class="columns is-multiline">
        <div class="field column is-4">
          <div class="control">
            <label class="label is-medium">Brand</label>
            <div class="control has-icons-left">
              <span class="select is-medium is-fullwidth">
                <%= f.input_field :brand, collection: Product::BRAND, prompt: "Select brand", required: true %>
              </span>
              <span class="icon is-medium is-left">
                <i class="fa fa-tag"></i>
              </span>
            </div>
          </div>
        </div>

        <div class="field column is-4">
          <div class="control">
            <label class="label is-medium">Finish</label>
            <div class="control has-icons-left">
              <span class="select is-medium is-fullwidth">
                <%= f.input_field :finish, collection: Product::FINISH, prompt: "Select finish", required: true %>
              </span>
              <span class="icon is-medium is-left">
                <i class="fa fa-paint-brush"></i>
              </span>
            </div>
          </div>
        </div>

        <div class="field column is-4">
          <div class="control">
            <label class="label is-medium">Condition</label>
            <div class="control has-icons-left">
              <span class="select is-medium is-fullwidth">
                <%= f.input_field :condition, collection: Product::CONDITION, prompt: "Select condition", required: true %>
              </span>
              <span class="icon is-medium is-left">
                <i class="fa fa-paint-brush"></i>
              </span>
            </div>
          </div>
        </div>
      </div>

      <div class="field mt-5">
        <div class="control">
          <label class="label is-medium">Add images</label>
          <div class="file is-medium is-boxed is-centered has-name is-fullwidth">
            <label class="file-label">
              <%= f.input :image, as: :file, 
                  input_html: { class: "file-input product-image" }, 
                  label: false, 
                  wrapper: false %>
              <span class="file-cta">
                <span class="file-icon"><i class="fa fa-upload fa-lg"></i></span>
                <span class="file-label">Choose a fileâ€¦</span>
              </span>
              <span class="file-name" id="filename">
                No file selected
              </span>
            </label>
          </div>
        </div>
      </div>
      <output id="list" class="mt-4"></output>

      <hr class="mt-6 mb-6" />

      <div class="field is-grouped is-grouped-centered">
        <div class="control">
          <%= f.button :submit, class: 'button is-warning is-medium px-6' %>
        </div>
        <div class="control">
          <%= link_to 'Cancel', products_path, class: 'button is-light is-medium' %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<% content_for :page_scripts do %>
  <script>
    document.querySelector('.product-image').onchange = function() {
      document.getElementById('filename').textContent = this.files[0].name;
    };
  </script>
<% end %>
